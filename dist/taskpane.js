/*! For license information please see taskpane.js.LICENSE.txt */
(()=>{function e(){var n,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function c(e,o,a,i){var c=o&&o.prototype instanceof s?o:s,d=Object.create(c.prototype);return t(d,"_invoke",function(e,t,o){var a,i,c,s=0,d=o||[],l=!1,f={p:0,n:0,v:n,a:m,f:m.bind(n,4),d:function(e,t){return a=e,i=0,c=n,f.n=t,u}};function m(e,t){for(i=e,c=t,r=0;!l&&s&&!o&&r<d.length;r++){var o,a=d[r],m=f.p,g=a[2];e>3?(o=g===t)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=n):a[0]<=m&&((o=e<2&&m<a[1])?(i=0,f.v=t,f.n=a[1]):m<g&&(o=e<3||a[0]>t||t>g)&&(a[4]=e,a[5]=t,f.n=g,i=0))}if(o||e>1)return u;throw l=!0,t}return function(o,d,g){if(s>1)throw TypeError("Generator is already running");for(l&&1===d&&m(d,g),i=d,c=g;(r=i<2?n:c)||!l;){a||(i?i<3?(i>1&&(f.n=-1),m(i,c)):f.n=c:f.v=c);try{if(s=2,a){if(i||(o="next"),r=a[o]){if(!(r=r.call(a,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,i<2&&(i=0)}else 1===i&&(r=a.return)&&r.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=n}else if((r=(l=f.n<0)?c:e.call(t,f))!==u)break}catch(e){a=n,i=1,c=e}finally{s=1}}return{value:r,done:l}}}(e,a,i),!0),d}var u={};function s(){}function d(){}function l(){}r=Object.getPrototypeOf;var f=[][a]?r(r([][a]())):(t(r={},a,function(){return this}),r),m=l.prototype=s.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,t(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e}return d.prototype=l,t(m,"constructor",l),t(l,"constructor",d),d.displayName="GeneratorFunction",t(l,i,"GeneratorFunction"),t(m),t(m,i,"Generator"),t(m,a,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:g}})()}function t(e,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}t=function(e,n,r,o){function i(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?a?a(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(i("next",0),i("throw",1),i("return",2))},t(e,n,r,o)}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,a){var i=e.apply(t,n);function c(e){r(i,o,a,c,u,"next",e)}function u(e){r(i,o,a,c,u,"throw",e)}c(void 0)})}}Office.onReady(function(e){e.host===Office.HostType.Outlook&&document.addEventListener("DOMContentLoaded",function(){document.getElementById("includeDate").addEventListener("change",i),document.getElementById("dateFormat").addEventListener("change",i),document.getElementById("includeSender").addEventListener("change",i),document.getElementById("includeSubject").addEventListener("change",i),document.getElementById("subjectLength").addEventListener("input",i),document.getElementById("separator").addEventListener("change",i),document.getElementById("convertToPDF").addEventListener("click",u),Office.context.mailbox.item.loadCustomPropertiesAsync(function(e){if(e.status===Office.AsyncResultStatus.Succeeded){var t=Office.context.mailbox.item;a={subject:t.subject||"No Subject",sender:t.sender?t.sender.displayName||t.sender.emailAddress:"Unknown Sender",dateTimeReceived:t.dateTimeCreated||new Date,body:null},i()}else y("Error loading email data: "+e.error.message,"error")}),i()})});var a=null;function i(){if(a){var e=document.getElementById("includeDate").checked,t=document.getElementById("dateFormat").value,n=document.getElementById("includeSender").checked,r=document.getElementById("includeSubject").checked,o=parseInt(document.getElementById("subjectLength").value)||50,i=document.getElementById("separator").value,u=[];if(e){var s=new Date(a.dateTimeReceived),d="";switch(t){case"YYYY-MM-DD":d=s.getFullYear()+"-"+String(s.getMonth()+1).padStart(2,"0")+"-"+String(s.getDate()).padStart(2,"0");break;case"DD-MM-YYYY":d=String(s.getDate()).padStart(2,"0")+"-"+String(s.getMonth()+1).padStart(2,"0")+"-"+s.getFullYear();break;case"MM-DD-YYYY":d=String(s.getMonth()+1).padStart(2,"0")+"-"+String(s.getDate()).padStart(2,"0")+"-"+s.getFullYear()}u.push(d)}if(n){var l=c(a.sender);u.push(l)}if(r){var f=a.subject;f.length>o&&(f=f.substring(0,o)+"...");var m=c(f);u.push(m)}var g=u.join(i)+".pdf";document.getElementById("filenamePreview").textContent=g||"email.pdf"}else document.getElementById("filenamePreview").textContent="Loading..."}function c(e){return e.replace(/[<>:"/\\|?*]/g,"").replace(/\s+/g," ").trim()}function u(){return s.apply(this,arguments)}function s(){return(s=o(e().m(function t(){var n,r;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,p(!0),y("",""),document.getElementById("convertToPDF").disabled=!0,e.n=1,d();case 1:return n=e.v,e.n=2,f(n);case 2:return e.n=3,g();case 3:y("Email successfully converted to PDF and categorized!","success"),e.n=5;break;case 4:e.p=4,r=e.v,console.error("Error converting to PDF:",r),y("Error converting to PDF: "+r.message,"error");case 5:return e.p=5,p(!1),document.getElementById("convertToPDF").disabled=!1,e.f(5);case 6:return e.a(2)}},t,null,[[0,4,5,6]])}))).apply(this,arguments)}function d(){return new Promise(function(e,t){Office.context.mailbox.item.body.getAsync(Office.CoercionType.Html,function(n){n.status===Office.AsyncResultStatus.Succeeded?e(n.value):t(new Error("Failed to get email body: "+n.error.message))})})}function l(){return new Promise(function(e,t){if(window.jsPDF)e();else{var n=document.createElement("script");n.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js",n.onload=function(){e()},n.onerror=function(e){t(new Error("Failed to load jsPDF library"))},document.head.appendChild(n)}})}function f(e){return m.apply(this,arguments)}function m(){return m=o(e().m(function t(n){return e().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(){var t=o(e().m(function t(r,o){var i,c,u,s,d,f,m,g,p,y;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,window.jsPDF){e.n=1;break}return e.n=1,l();case 1:for(i=new window.jsPDF.jsPDF,c=document.getElementById("filenamePreview").textContent,i.setProperties({title:c,subject:a.subject,author:a.sender,creator:"Outlook PDF Converter"}),i.setFontSize(16),i.text("Email Details",20,20),i.setFontSize(12),u=35,i.text("From: ".concat(a.sender),20,u),u+=10,i.text("Subject: ".concat(a.subject),20,u),u+=10,s=new Date(a.dateTimeReceived).toLocaleString(),i.text("Date: ".concat(s),20,u),u+=20,i.setFontSize(10),(d=document.createElement("div")).innerHTML=n,f=d.textContent||d.innerText||"",m=i.splitTextToSize(f,170),g=i.internal.pageSize.height,p=0;p<m.length;p++)u+5>g-20&&(i.addPage(),u=20),i.text(m[p],20,u),u+=5;i.save(c),r(),e.n=3;break;case 2:e.p=2,y=e.v,o(y);case 3:return e.a(2)}},t,null,[[0,2]])}));return function(e,n){return t.apply(this,arguments)}}()))},t)})),m.apply(this,arguments)}function g(){return new Promise(function(e,t){Office.context.mailbox.item.categories.getAsync(function(r){if(r.status===Office.AsyncResultStatus.Succeeded){var o=r.value;if(o.some(function(e){return"PDF"===e.displayName}))e();else{var a={displayName:"PDF",color:Office.MailboxEnums.CategoryColor.Preset1},i=[].concat(function(e){if(Array.isArray(e))return n(e)}(c=o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(c)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[a]);Office.context.mailbox.item.categories.setAsync(i,function(n){n.status===Office.AsyncResultStatus.Succeeded?e():t(new Error("Failed to add PDF category: "+n.error.message))})}}else t(new Error("Failed to get current categories: "+r.error.message));var c})})}function p(e){var t=document.getElementById("progressIndicator");e?t.classList.remove("hidden"):t.classList.add("hidden")}function y(e,t){var n=document.getElementById("statusSection"),r=document.getElementById("statusMessage");e?(r.textContent=e,n.className="status",t&&n.classList.add(t),n.classList.remove("hidden")):n.classList.add("hidden")}})();
//# sourceMappingURL=taskpane.js.map